‚úì Directory ensured: dataset/
‚úì Directory ensured: model/
‚úì Directory ensured: result/
[GPU] Using GPU:0 -> PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')

[Phase 1] Loading dataset from dataset/dataset_samples1500_sats12.pkl...
‚úì Dataset loaded from disk

[Phase 1] Initializing ISAC System...
[ISAC] Using TR 38.811 DenseUrban (NTN)
[ISAC] System initialized successfully

=== DATA VALIDATION ===
Benign samples: 1500
Attack samples: 1500
Attack samples with emitter locations: 1500
Power ratio (attack/benign): 0.5043
‚ö†Ô∏è WARNING: Power ratio too low - dataset may be biased!

[Phase 2] Feature extraction and split...

[Feature] Extracting features (GPU)...
[Feature] Creating constellation-based groups...
‚úì Found 35 unique satellite constellations
‚úì Train groups: 28
‚úì Test groups: 7
‚úì No group overlap ‚Äî proper split! üéØ
‚úì Train: 2526 samples
‚úì Test: 474 samples

[Phase 3] Training detector model...

[Model] Building H100-optimized dual-input CNN...

=== DATASET DIAGNOSTICS ===
Train set: 2526 samples
Test set:  474 samples
Batch size: 64
Xs_tr shape: (2526, 64, 64, 1)
Xr_tr shape: (2526, 8, 8, 3)
Xs_te shape: (474, 64, 64, 1)
Xr_te shape: (474, 8, 8, 3)

[Model] Training for 30 epochs...
Epoch 1/30
39/39 [==============================] - ETA: 0s - loss: 0.5875 - accuracy: 0.9018 - auc: 0.9657
Epoch 1: val_accuracy improved from -inf to 0.54430, saving model to model/best_model.keras
39/39 [==============================] - 15s 375ms/step - loss: 0.5875 - accuracy: 0.9018 - auc: 0.9657 - val_loss: 1.1056 - val_accuracy: 0.5443 - val_auc: 0.9999
Epoch 2/30
39/39 [==============================] - ETA: 0s - loss: 0.4083 - accuracy: 0.9499 - auc: 0.9882
Epoch 2: val_accuracy did not improve from 0.54430
39/39 [==============================] - 0s 4ms/step - loss: 0.4083 - accuracy: 0.9499 - auc: 0.9882 - val_loss: 1.1030 - val_accuracy: 0.5443 - val_auc: 1.0000
Epoch 3/30
39/39 [==============================] - ETA: 0s - loss: 0.3116 - accuracy: 0.9756 - auc: 0.9981
Epoch 3: val_accuracy did not improve from 0.54430
39/39 [==============================] - 0s 4ms/step - loss: 0.3116 - accuracy: 0.9756 - auc: 0.9981 - val_loss: 0.6977 - val_accuracy: 0.5443 - val_auc: 1.0000
Epoch 4/30
39/39 [==============================] - ETA: 0s - loss: 0.2358 - accuracy: 0.9976 - auc: 1.0000
Epoch 4: val_accuracy improved from 0.54430 to 0.99156, saving model to model/best_model.keras
39/39 [==============================] - 0s 9ms/step - loss: 0.2358 - accuracy: 0.9976 - auc: 1.0000 - val_loss: 0.3844 - val_accuracy: 0.9916 - val_auc: 1.0000
Epoch 5/30
39/39 [==============================] - ETA: 0s - loss: 0.2047 - accuracy: 0.9992 - auc: 1.0000
Epoch 5: val_accuracy improved from 0.99156 to 0.99789, saving model to model/best_model.keras
39/39 [==============================] - 0s 8ms/step - loss: 0.2047 - accuracy: 0.9992 - auc: 1.0000 - val_loss: 0.2990 - val_accuracy: 0.9979 - val_auc: 1.0000
Epoch 6/30
39/39 [==============================] - ETA: 0s - loss: 0.1812 - accuracy: 1.0000 - auc: 1.0000
Epoch 6: val_accuracy did not improve from 0.99789
39/39 [==============================] - 0s 4ms/step - loss: 0.1812 - accuracy: 1.0000 - auc: 1.0000 - val_loss: 0.2881 - val_accuracy: 0.9895 - val_auc: 1.0000
Epoch 7/30
39/39 [==============================] - ETA: 0s - loss: 0.1617 - accuracy: 1.0000 - auc: 1.0000
Epoch 7: val_accuracy did not improve from 0.99789
39/39 [==============================] - 0s 4ms/step - loss: 0.1617 - accuracy: 1.0000 - auc: 1.0000 - val_loss: 0.2924 - val_accuracy: 0.9768 - val_auc: 1.0000
Epoch 8/30
39/39 [==============================] - ETA: 0s - loss: 0.1431 - accuracy: 1.0000 - auc: 1.0000
Epoch 8: val_accuracy did not improve from 0.99789
39/39 [==============================] - 0s 4ms/step - loss: 0.1431 - accuracy: 1.0000 - auc: 1.0000 - val_loss: 0.3703 - val_accuracy: 0.8755 - val_auc: 1.0000
Epoch 9/30
39/39 [==============================] - ETA: 0s - loss: 0.1269 - accuracy: 1.0000 - auc: 1.0000
Epoch 9: val_accuracy did not improve from 0.99789
39/39 [==============================] - 0s 4ms/step - loss: 0.1269 - accuracy: 1.0000 - auc: 1.0000 - val_loss: 0.3261 - val_accuracy: 0.8987 - val_auc: 1.0000
Epoch 10/30
39/39 [==============================] - ETA: 0s - loss: 0.1126 - accuracy: 1.0000 - auc: 1.0000
Epoch 10: val_accuracy did not improve from 0.99789
39/39 [==============================] - 0s 4ms/step - loss: 0.1126 - accuracy: 1.0000 - auc: 1.0000 - val_loss: 0.3754 - val_accuracy: 0.8523 - val_auc: 1.0000
Epoch 11/30
39/39 [==============================] - ETA: 0s - loss: 0.0991 - accuracy: 1.0000 - auc: 1.0000
Epoch 11: val_accuracy did not improve from 0.99789
39/39 [==============================] - 0s 4ms/step - loss: 0.0991 - accuracy: 1.0000 - auc: 1.0000 - val_loss: 0.2619 - val_accuracy: 0.9177 - val_auc: 1.0000
Epoch 12/30
39/39 [==============================] - ETA: 0s - loss: 0.0875 - accuracy: 1.0000 - auc: 1.0000
Epoch 12: val_accuracy did not improve from 0.99789
39/39 [==============================] - 0s 4ms/step - loss: 0.0875 - accuracy: 1.0000 - auc: 1.0000 - val_loss: 0.2492 - val_accuracy: 0.9241 - val_auc: 1.0000
Epoch 13/30
39/39 [==============================] - ETA: 0s - loss: 0.0781 - accuracy: 0.9996 - auc: 1.0000
Epoch 13: val_accuracy did not improve from 0.99789
39/39 [==============================] - 0s 4ms/step - loss: 0.0781 - accuracy: 0.9996 - auc: 1.0000 - val_loss: 0.2197 - val_accuracy: 0.9599 - val_auc: 1.0000
Epoch 14/30
39/39 [==============================] - ETA: 0s - loss: 0.0685 - accuracy: 1.0000 - auc: 1.0000
Epoch 14: val_accuracy improved from 0.99789 to 1.00000, saving model to model/best_model.keras
39/39 [==============================] - 0s 7ms/step - loss: 0.0685 - accuracy: 1.0000 - auc: 1.0000 - val_loss: 0.0969 - val_accuracy: 1.0000 - val_auc: 1.0000
Epoch 15/30
39/39 [==============================] - ETA: 0s - loss: 0.0606 - accuracy: 1.0000 - auc: 1.0000
Epoch 15: val_accuracy did not improve from 1.00000
39/39 [==============================] - 0s 4ms/step - loss: 0.0606 - accuracy: 1.0000 - auc: 1.0000 - val_loss: 0.0634 - val_accuracy: 1.0000 - val_auc: 1.0000
Epoch 16/30
39/39 [==============================] - ETA: 0s - loss: 0.0535 - accuracy: 1.0000 - auc: 1.0000
Epoch 16: val_accuracy did not improve from 1.00000
39/39 [==============================] - 0s 4ms/step - loss: 0.0535 - accuracy: 1.0000 - auc: 1.0000 - val_loss: 0.0510 - val_accuracy: 1.0000 - val_auc: 1.0000
Epoch 17/30
39/39 [==============================] - ETA: 0s - loss: 0.0474 - accuracy: 1.0000 - auc: 1.0000
Epoch 17: val_accuracy did not improve from 1.00000
39/39 [==============================] - 0s 4ms/step - loss: 0.0474 - accuracy: 1.0000 - auc: 1.0000 - val_loss: 0.0445 - val_accuracy: 1.0000 - val_auc: 1.0000
Epoch 18/30
39/39 [==============================] - ETA: 0s - loss: 0.0420 - accuracy: 1.0000 - auc: 1.0000
Epoch 18: val_accuracy did not improve from 1.00000
39/39 [==============================] - 0s 4ms/step - loss: 0.0420 - accuracy: 1.0000 - auc: 1.0000 - val_loss: 0.0394 - val_accuracy: 1.0000 - val_auc: 1.0000
Epoch 19/30
39/39 [==============================] - ETA: 0s - loss: 0.0372 - accuracy: 1.0000 - auc: 1.0000
Epoch 19: val_accuracy did not improve from 1.00000
39/39 [==============================] - 0s 4ms/step - loss: 0.0372 - accuracy: 1.0000 - auc: 1.0000 - val_loss: 0.0350 - val_accuracy: 1.0000 - val_auc: 1.0000
Epoch 20/30
39/39 [==============================] - ETA: 0s - loss: 0.0331 - accuracy: 1.0000 - auc: 1.0000
Epoch 20: val_accuracy did not improve from 1.00000
39/39 [==============================] - 0s 4ms/step - loss: 0.0331 - accuracy: 1.0000 - auc: 1.0000 - val_loss: 0.0311 - val_accuracy: 1.0000 - val_auc: 1.0000
Epoch 21/30
39/39 [==============================] - ETA: 0s - loss: 0.0295 - accuracy: 1.0000 - auc: 1.0000
Epoch 21: val_accuracy did not improve from 1.00000
39/39 [==============================] - 0s 4ms/step - loss: 0.0295 - accuracy: 1.0000 - auc: 1.0000 - val_loss: 0.0278 - val_accuracy: 1.0000 - val_auc: 1.0000
Epoch 22/30
39/39 [==============================] - ETA: 0s - loss: 0.0264 - accuracy: 1.0000 - auc: 1.0000
Epoch 22: val_accuracy did not improve from 1.00000
39/39 [==============================] - 0s 4ms/step - loss: 0.0264 - accuracy: 1.0000 - auc: 1.0000 - val_loss: 0.0248 - val_accuracy: 1.0000 - val_auc: 1.0000
Epoch 23/30
39/39 [==============================] - ETA: 0s - loss: 0.0237 - accuracy: 1.0000 - auc: 1.0000
Epoch 23: val_accuracy did not improve from 1.00000
39/39 [==============================] - 0s 4ms/step - loss: 0.0237 - accuracy: 1.0000 - auc: 1.0000 - val_loss: 0.0223 - val_accuracy: 1.0000 - val_auc: 1.0000
Epoch 24/30
39/39 [==============================] - ETA: 0s - loss: 0.0213 - accuracy: 1.0000 - auc: 1.0000
Epoch 24: val_accuracy did not improve from 1.00000
39/39 [==============================] - 0s 4ms/step - loss: 0.0213 - accuracy: 1.0000 - auc: 1.0000 - val_loss: 0.0201 - val_accuracy: 1.0000 - val_auc: 1.0000
Epoch 24: early stopping
Restoring model weights from the end of the best epoch: 14.

=== TRAINING SUMMARY ===
Best epoch: 2
Best val_auc: 1.0000
Final train_acc: 1.0000

[Phase 4] Evaluating detector...

[Eval] Evaluating on test set...
Test Results ‚Üí Loss: 0.0969 | Acc: 1.0000 | AUC: 1.0000

=== THRESHOLD TUNING ===
Default threshold (0.5): F1 = 1.0000
Optimized threshold: 0.5014
  Best F1 score: 1.0000
  Precision: 1.0000
  Recall: 1.0000

[Phase 5] Running TDoA localization...

=== PHASE 8: TDoA-BASED LOCALIZATION ===
Processing true positives...
  Sample 758 | GT [ 88616.98677975 -22139.48005346] | EST [ 88629.65911159 -22100.39340885] | Error=41.09 m
  Sample 779 | GT [147241.05455534 139076.8804124 ] | EST [147259.8917532  139081.82560642] | Error=19.48 m
  Sample 793 | GT [137507.29493754 -37489.30621383] | EST [137495.10311781 -37500.37850194] | Error=16.47 m

=== TDoA Localization Results ===
Median Error: 44.04 m
Mean Error  : 1072.47 m
90th Perc.  : 148.94 m
Total samples: 122

=== CRLB Analysis ===
System timing resolution: 8.14 ns
Assumed timing error (œÉ_t): 9.77 ns
Equivalent range error (œÉ_d): 2.93 m
Mean CRLB: 1.45 m
Median CRLB: 1.44 m
Achieved median error: 44.04 m
Ratio (achieved/CRLB): 30.60√ó
Efficiency: 3.3% of the CRLB
‚úì CRLB analysis saved to result/crlb_values.csv
‚úì Localization errors saved to result/localization_errors.txt

[Phase 6] Generating plots...

=== GENERATING PAPER PLOTS ===
‚úì ROC curve saved to result/1_roc_curve.pdf
‚úì Precision-Recall curve saved to result/2_precision_recall_curve.pdf
‚úì Confusion Matrix saved to result/3_confusion_matrix.pdf
‚úì Training History saved to result/5_training_history.pdf

=== CALIBRATION METRICS ===
Brier Score: 0.0054
ECE (Expected Calibration Error): 0.2072
‚úì Calibration curve saved
‚úì Power Spectrum saved to result/6_power_spectrum.pdf
‚úì F1 vs Threshold saved to result/7_f1_vs_threshold.pdf
‚úì Spectrogram Examples saved to result/9_spectrogram_examples.pdf
‚úì Localization CDF saved to result/4_localization_cdf.pdf
‚úì Localization Histogram saved to result/8_localization_histogram.pdf
‚úì Satellite Geometry saved to result/10_satellite_geometry.pdf
‚úì All plots generated successfully

============================================================
SIMULATION COMPLETE - SUMMARY
============================================================
Dataset: 3000 samples (1500 per class)
Model: Dual-Input CNN (saved to model/)
Results: All plots saved to result/
Best Threshold: 0.5014 (F1=1.0000)
Localization: Median Error = 44.04 m, 90th = 148.94 m
============================================================
‚úì Pipeline execution completed successfully
