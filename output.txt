 python3 main.py 
2025-10-17 16:37:01.851218: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-10-17 16:37:01.902544: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Phase 1: Setting up LEO Satellite ISAC System...
Phase 2: Defining ISAC Waveform Generation...
Phase 3: Generating Benign and Attack Datasets...
Phase 4: Defining Feature Extraction Pipeline...
Phase 5: Building and Training ML Detector...
Phase 6: Defining Localization Logic...
Integrating 3GPP TR38.811 NTN channel model (DenseUrban)...
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1760733425.271676   43384 gpu_device.cc:2020] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 92981 MB memory:  -> device: 0, name: NVIDIA H100 NVL, pci bus id: 0000:43:00.0, compute capability: 9.0
I0000 00:00:1760733428.626031   43384 cuda_solvers.cc:175] Creating GpuSolver handles for stream 0x2c85ebe0
/workspace/main.py:216: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  ofdm_frame_np[0, 0, 0, symbol_idx, subcarrier_idx] += complex(covert_symbols_np[i])
Before replication - h_time shape: (1, 1, 1, 1, 128, 1, 25)
h_freq_broadcast shape: (1, 1, 1, 10, 64)
Channel gain (mean magnitude): 0.1999
Generated sample 100/3000...
Generated sample 200/3000...
Generated sample 300/3000...
Generated sample 400/3000...
Generated sample 500/3000...
Generated sample 600/3000...
Generated sample 700/3000...
Generated sample 800/3000...
Generated sample 900/3000...
Generated sample 1000/3000...
Generated sample 1100/3000...
Generated sample 1200/3000...
Generated sample 1300/3000...
Generated sample 1400/3000...
Generated sample 1500/3000...
Generated sample 1600/3000...
Generated sample 1700/3000...
Generated sample 1800/3000...
Generated sample 1900/3000...
Generated sample 2000/3000...
Generated sample 2100/3000...
Generated sample 2200/3000...
Generated sample 2300/3000...
Generated sample 2400/3000...
Generated sample 2500/3000...
Generated sample 2600/3000...
Generated sample 2700/3000...
Generated sample 2800/3000...
Generated sample 2900/3000...
Generated sample 3000/3000...

=== DATA VALIDATION ===
Benign samples: 1500
Attack samples: 1500
Attack samples with emitter locations: 1500
Benign sample power: 0.112846
Attack sample power: 0.125660
Power ratio (attack/benign): 1.1135
/workspace/main.py:472: UserWarning: Input data is complex, switching to return_onesided=False
  _, _, Zxx = stft(iq, nperseg=nperseg)
Extracted features for sample 100/3000...
Extracted features for sample 200/3000...
Extracted features for sample 300/3000...
Extracted features for sample 400/3000...
Extracted features for sample 500/3000...
Extracted features for sample 600/3000...
Extracted features for sample 700/3000...
Extracted features for sample 800/3000...
Extracted features for sample 900/3000...
Extracted features for sample 1000/3000...
Extracted features for sample 1100/3000...
Extracted features for sample 1200/3000...
Extracted features for sample 1300/3000...
Extracted features for sample 1400/3000...
Extracted features for sample 1500/3000...
Extracted features for sample 1600/3000...
Extracted features for sample 1700/3000...
Extracted features for sample 1800/3000...
Extracted features for sample 1900/3000...
Extracted features for sample 2000/3000...
Extracted features for sample 2100/3000...
Extracted features for sample 2200/3000...
Extracted features for sample 2300/3000...
Extracted features for sample 2400/3000...
Extracted features for sample 2500/3000...
Extracted features for sample 2600/3000...
Extracted features for sample 2700/3000...
Extracted features for sample 2800/3000...
Extracted features for sample 2900/3000...
Extracted features for sample 3000/3000...

Generating diagnostic visualizations...
Feature comparison saved to feature_comparison.pdf

Extracting spectrogram features...
/workspace/main.py:472: UserWarning: Input data is complex, switching to return_onesided=False
  _, _, Zxx = stft(iq, nperseg=nperseg)
Extracted features for sample 100/3000...
Extracted features for sample 200/3000...
Extracted features for sample 300/3000...
Extracted features for sample 400/3000...
Extracted features for sample 500/3000...
Extracted features for sample 600/3000...
Extracted features for sample 700/3000...
Extracted features for sample 800/3000...
Extracted features for sample 900/3000...
Extracted features for sample 1000/3000...
Extracted features for sample 1100/3000...
Extracted features for sample 1200/3000...
Extracted features for sample 1300/3000...
Extracted features for sample 1400/3000...
Extracted features for sample 1500/3000...
Extracted features for sample 1600/3000...
Extracted features for sample 1700/3000...
Extracted features for sample 1800/3000...
Extracted features for sample 1900/3000...
Extracted features for sample 2000/3000...
Extracted features for sample 2100/3000...
Extracted features for sample 2200/3000...
Extracted features for sample 2300/3000...
Extracted features for sample 2400/3000...
Extracted features for sample 2500/3000...
Extracted features for sample 2600/3000...
Extracted features for sample 2700/3000...
Extracted features for sample 2800/3000...
Extracted features for sample 2900/3000...
Extracted features for sample 3000/3000...

Extracting RX signal features (contains covert data)...
Extracted RX signal features for sample 500/3000...
Extracted RX signal features for sample 1000/3000...
Extracted RX signal features for sample 1500/3000...
Extracted RX signal features for sample 2000/3000...
Extracted RX signal features for sample 2500/3000...
Extracted RX signal features for sample 3000/3000...

Final dataset: 3000 samples
Spectrogram shape: (3000, 64, 64, 1)
RX signal features shape: (3000, 8, 8, 3)

Training the dual-input CNN detector...
Epoch 1/30
2025-10-17 16:49:34.899307: I external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:473] Loaded cuDNN version 90701
2025-10-17 16:49:35.498774: I external/local_xla/xla/service/service.cc:163] XLA service 0x710923879a80 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2025-10-17 16:49:35.498807: I external/local_xla/xla/service/service.cc:171]   StreamExecutor device (0): NVIDIA H100 NVL, Compute Capability 9.0
2025-10-17 16:49:35.503166: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:269] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
I0000 00:00:1760734175.579687   43642 device_compiler.h:196] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
 1/60 [..............................] - ETA: 2:26 - loss: 0.69 2/60 [>.............................] - ETA: 11s - loss: 0.696 3/60 [>.............................] - ETA: 9s - loss: 0.6937 4/60 [=>............................] - ETA: 8s - loss: 0.6934 6/60 [==>...........................] - ETA: 5s - loss: 0.6977 8/60 [===>..........................] - ETA: 4s - loss: 0.696413/60 [=====>........................] - ETA: 2s - loss: 0.692025/60 [===========>..................] - ETA: 1s - loss: 0.695237/60 [=================>............] - ETA: 0s - loss: 0.694349/60 [=======================>......] - ETA: 0s - loss: 0.693360/60 [==============================] - 4s 19ms/step - loss: 0.6913 - accuracy: 0.5167 - val_loss: 0.6885 - val_accuracy: 0.4812
Epoch 2/30
 1/60 [..............................] - ETA: 0s - loss: 0.667213/60 [=====>........................] - ETA: 0s - loss: 0.678725/60 [===========>..................] - ETA: 0s - loss: 0.667037/60 [=================>............] - ETA: 0s - loss: 0.645049/60 [=======================>......] - ETA: 0s - loss: 0.618960/60 [==============================] - ETA: 0s - loss: 0.604860/60 [==============================] - 0s 7ms/step - loss: 0.6048 - accuracy: 0.6766 - val_loss: 0.4733 - val_accuracy: 0.7708
Epoch 3/30
 1/60 [..............................] - ETA: 0s - loss: 0.479412/60 [=====>........................] - ETA: 0s - loss: 0.466724/60 [===========>..................] - ETA: 0s - loss: 0.452136/60 [=================>............] - ETA: 0s - loss: 0.452648/60 [=======================>......] - ETA: 0s - loss: 0.457660/60 [==============================] - ETA: 0s - loss: 0.452560/60 [==============================] - 0s 6ms/step - loss: 0.4525 - accuracy: 0.7823 - val_loss: 0.4163 - val_accuracy: 0.8104
Epoch 4/30
 1/60 [..............................] - ETA: 0s - loss: 0.492812/60 [=====>........................] - ETA: 0s - loss: 0.421424/60 [===========>..................] - ETA: 0s - loss: 0.447235/60 [================>.............] - ETA: 0s - loss: 0.427746/60 [======================>.......] - ETA: 0s - loss: 0.430257/60 [===========================>..] - ETA: 0s - loss: 0.429660/60 [==============================] - 0s 6ms/step - loss: 0.4287 - accuracy: 0.8016 - val_loss: 0.3908 - val_accuracy: 0.8146
Epoch 5/30
 1/60 [..............................] - ETA: 0s - loss: 0.350113/60 [=====>........................] - ETA: 0s - loss: 0.396124/60 [===========>..................] - ETA: 0s - loss: 0.370235/60 [================>.............] - ETA: 0s - loss: 0.385646/60 [======================>.......] - ETA: 0s - loss: 0.391257/60 [===========================>..] - ETA: 0s - loss: 0.399960/60 [==============================] - 0s 6ms/step - loss: 0.3960 - accuracy: 0.8203 - val_loss: 0.3767 - val_accuracy: 0.8188
Epoch 6/30
 1/60 [..............................] - ETA: 0s - loss: 0.202513/60 [=====>........................] - ETA: 0s - loss: 0.386425/60 [===========>..................] - ETA: 0s - loss: 0.387537/60 [=================>............] - ETA: 0s - loss: 0.383149/60 [=======================>......] - ETA: 0s - loss: 0.372260/60 [==============================] - 0s 6ms/step - loss: 0.3855 - accuracy: 0.8208 - val_loss: 0.4096 - val_accuracy: 0.8042
Epoch 7/30
 1/60 [..............................] - ETA: 0s - loss: 0.401313/60 [=====>........................] - ETA: 0s - loss: 0.365725/60 [===========>..................] - ETA: 0s - loss: 0.382737/60 [=================>............] - ETA: 0s - loss: 0.371549/60 [=======================>......] - ETA: 0s - loss: 0.371660/60 [==============================] - 0s 6ms/step - loss: 0.3733 - accuracy: 0.8281 - val_loss: 0.3771 - val_accuracy: 0.8292
Epoch 8/30
 1/60 [..............................] - ETA: 0s - loss: 0.402213/60 [=====>........................] - ETA: 0s - loss: 0.346025/60 [===========>..................] - ETA: 0s - loss: 0.360437/60 [=================>............] - ETA: 0s - loss: 0.368449/60 [=======================>......] - ETA: 0s - loss: 0.371260/60 [==============================] - 0s 6ms/step - loss: 0.3645 - accuracy: 0.8370 - val_loss: 0.3763 - val_accuracy: 0.8313
Epoch 9/30
 1/60 [..............................] - ETA: 0s - loss: 0.410613/60 [=====>........................] - ETA: 0s - loss: 0.380825/60 [===========>..................] - ETA: 0s - loss: 0.370637/60 [=================>............] - ETA: 0s - loss: 0.359149/60 [=======================>......] - ETA: 0s - loss: 0.356860/60 [==============================] - 0s 7ms/step - loss: 0.3594 - accuracy: 0.8505 - val_loss: 0.3698 - val_accuracy: 0.8292
Epoch 10/30
 1/60 [..............................] - ETA: 0s - loss: 0.182712/60 [=====>........................] - ETA: 0s - loss: 0.318924/60 [===========>..................] - ETA: 0s - loss: 0.354535/60 [================>.............] - ETA: 0s - loss: 0.358747/60 [======================>.......] - ETA: 0s - loss: 0.349559/60 [============================>.] - ETA: 0s - loss: 0.355960/60 [==============================] - 0s 6ms/step - loss: 0.3567 - accuracy: 0.8307 - val_loss: 0.3635 - val_accuracy: 0.8250
Epoch 11/30
 1/60 [..............................] - ETA: 0s - loss: 0.312213/60 [=====>........................] - ETA: 0s - loss: 0.340825/60 [===========>..................] - ETA: 0s - loss: 0.351737/60 [=================>............] - ETA: 0s - loss: 0.340749/60 [=======================>......] - ETA: 0s - loss: 0.333360/60 [==============================] - 0s 6ms/step - loss: 0.3308 - accuracy: 0.8609 - val_loss: 0.3742 - val_accuracy: 0.8083
Epoch 12/30
 1/60 [..............................] - ETA: 0s - loss: 0.258212/60 [=====>........................] - ETA: 0s - loss: 0.334924/60 [===========>..................] - ETA: 0s - loss: 0.323036/60 [=================>............] - ETA: 0s - loss: 0.329048/60 [=======================>......] - ETA: 0s - loss: 0.332460/60 [==============================] - ETA: 0s - loss: 0.324160/60 [==============================] - 0s 6ms/step - loss: 0.3241 - accuracy: 0.8443 - val_loss: 0.3733 - val_accuracy: 0.8292
Epoch 13/30
 1/60 [..............................] - ETA: 0s - loss: 0.364413/60 [=====>........................] - ETA: 0s - loss: 0.348524/60 [===========>..................] - ETA: 0s - loss: 0.315935/60 [================>.............] - ETA: 0s - loss: 0.318747/60 [======================>.......] - ETA: 0s - loss: 0.326559/60 [============================>.] - ETA: 0s - loss: 0.319460/60 [==============================] - 0s 6ms/step - loss: 0.3179 - accuracy: 0.8594 - val_loss: 0.3790 - val_accuracy: 0.8354
Epoch 14/30
 1/60 [..............................] - ETA: 0s - loss: 0.369313/60 [=====>........................] - ETA: 0s - loss: 0.325325/60 [===========>..................] - ETA: 0s - loss: 0.331137/60 [=================>............] - ETA: 0s - loss: 0.319649/60 [=======================>......] - ETA: 0s - loss: 0.310560/60 [==============================] - 0s 6ms/step - loss: 0.3188 - accuracy: 0.8526 - val_loss: 0.3724 - val_accuracy: 0.8188
Epoch 15/30
 1/60 [..............................] - ETA: 0s - loss: 0.247413/60 [=====>........................] - ETA: 0s - loss: 0.313125/60 [===========>..................] - ETA: 0s - loss: 0.296337/60 [=================>............] - ETA: 0s - loss: 0.299749/60 [=======================>......] - ETA: 0s - loss: 0.300260/60 [==============================] - 0s 6ms/step - loss: 0.3022 - accuracy: 0.8682 - val_loss: 0.4021 - val_accuracy: 0.8000
Epoch 16/30
 1/60 [..............................] - ETA: 0s - loss: 0.334613/60 [=====>........................] - ETA: 0s - loss: 0.257125/60 [===========>..................] - ETA: 0s - loss: 0.274637/60 [=================>............] - ETA: 0s - loss: 0.281649/60 [=======================>......] - ETA: 0s - loss: 0.286060/60 [==============================] - 0s 7ms/step - loss: 0.2863 - accuracy: 0.8755 - val_loss: 0.3826 - val_accuracy: 0.8271
Epoch 17/30
 1/60 [..............................] - ETA: 0s - loss: 0.174212/60 [=====>........................] - ETA: 0s - loss: 0.276124/60 [===========>..................] - ETA: 0s - loss: 0.248136/60 [=================>............] - ETA: 0s - loss: 0.260448/60 [=======================>......] - ETA: 0s - loss: 0.266160/60 [==============================] - ETA: 0s - loss: 0.269160/60 [==============================] - 0s 6ms/step - loss: 0.2691 - accuracy: 0.8802 - val_loss: 0.3653 - val_accuracy: 0.8208
Epoch 18/30
 1/60 [..............................] - ETA: 0s - loss: 0.226712/60 [=====>........................] - ETA: 0s - loss: 0.249724/60 [===========>..................] - ETA: 0s - loss: 0.249336/60 [=================>............] - ETA: 0s - loss: 0.255048/60 [=======================>......] - ETA: 0s - loss: 0.268060/60 [==============================] - ETA: 0s - loss: 0.267460/60 [==============================] - 0s 6ms/step - loss: 0.2674 - accuracy: 0.8813 - val_loss: 0.3810 - val_accuracy: 0.8083
Epoch 19/30
 1/60 [..............................] - ETA: 0s - loss: 0.226913/60 [=====>........................] - ETA: 0s - loss: 0.225725/60 [===========>..................] - ETA: 0s - loss: 0.236737/60 [=================>............] - ETA: 0s - loss: 0.250049/60 [=======================>......] - ETA: 0s - loss: 0.243560/60 [==============================] - 0s 6ms/step - loss: 0.2539 - accuracy: 0.8906 - val_loss: 0.4160 - val_accuracy: 0.7875
Epoch 20/30
 1/60 [..............................] - ETA: 0s - loss: 0.209513/60 [=====>........................] - ETA: 0s - loss: 0.266425/60 [===========>..................] - ETA: 0s - loss: 0.255536/60 [=================>............] - ETA: 0s - loss: 0.241747/60 [======================>.......] - ETA: 0s - loss: 0.242559/60 [============================>.] - ETA: 0s - loss: 0.244760/60 [==============================] - 0s 6ms/step - loss: 0.2444 - accuracy: 0.8979 - val_loss: 0.4039 - val_accuracy: 0.8083
Epoch 21/30
 1/60 [..............................] - ETA: 0s - loss: 0.167113/60 [=====>........................] - ETA: 0s - loss: 0.243825/60 [===========>..................] - ETA: 0s - loss: 0.239737/60 [=================>............] - ETA: 0s - loss: 0.224849/60 [=======================>......] - ETA: 0s - loss: 0.225260/60 [==============================] - 0s 6ms/step - loss: 0.2269 - accuracy: 0.9141 - val_loss: 0.3983 - val_accuracy: 0.8271
Epoch 22/30
 1/60 [..............................] - ETA: 0s - loss: 0.110812/60 [=====>........................] - ETA: 0s - loss: 0.244423/60 [==========>...................] - ETA: 0s - loss: 0.208535/60 [================>.............] - ETA: 0s - loss: 0.202346/60 [======================>.......] - ETA: 0s - loss: 0.200558/60 [============================>.] - ETA: 0s - loss: 0.210460/60 [==============================] - 0s 6ms/step - loss: 0.2098 - accuracy: 0.9151 - val_loss: 0.4308 - val_accuracy: 0.8000
Epoch 23/30
 1/60 [..............................] - ETA: 0s - loss: 0.281012/60 [=====>........................] - ETA: 0s - loss: 0.182624/60 [===========>..................] - ETA: 0s - loss: 0.182636/60 [=================>............] - ETA: 0s - loss: 0.190048/60 [=======================>......] - ETA: 0s - loss: 0.190959/60 [============================>.] - ETA: 0s - loss: 0.188260/60 [==============================] - 0s 7ms/step - loss: 0.1874 - accuracy: 0.9240 - val_loss: 0.4851 - val_accuracy: 0.8167
Epoch 23: early stopping
Restoring model weights from the end of the best epoch: 13.

=== TRAINING SUMMARY ===
Best epoch: 13
Best val_accuracy: 0.8354
Final train_accuracy: 0.9240

Evaluating detector performance...
Test Accuracy: 0.8417
19/19 [==============================] - 0s 6ms/step

=== CONFUSION MATRIX ===
                Predicted
              Benign  Attack
Actual Benign   250      63
       Attack    32     255

=== CLASSIFICATION REPORT ===
              precision    recall  f1-score   support

      Benign       0.89      0.80      0.84       313
      Attack       0.80      0.89      0.84       287

    accuracy                           0.84       600
   macro avg       0.84      0.84      0.84       600
weighted avg       0.85      0.84      0.84       600

ROC curve saved to roc_curve.pdf

Performing localization...
Median Localization Error: 244.60 meters
Localization CDF plot saved to localization_cdf.pdf

Simulation complete.
root@a1605f3cf1ae:/workspace# ^C
root@a1605f3cf1ae:/workspace# 