root@d05388087b30:/workspace# python3 main.py
2025-10-21 17:35:20.678754: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-10-21 17:35:20.729859: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
✓ Directory ensured: dataset/
✓ Directory ensured: model/
✓ Directory ensured: result/
Phase 1: Initializing ISAC System (CPU-heavy init)...
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1761082524.611209   63457 gpu_device.cc:2020] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 92981 MB memory:  -> device: 0, name: NVIDIA H100 NVL, pci bus id: 0000:43:00.0, compute capability: 9.0
Using TR 38.811 DenseUrban model (NTN).
I0000 00:00:1761082528.277798   63457 cuda_solvers.cc:175] Creating GpuSolver handles for stream 0x4704c520
Phase 2/3: Generating multi-satellite dataset (GPU-friendly ops where possible)...
✓ Satellite altitudes (with diversity): ['580.9km', '567.0km', '573.2km', '526.0km', '528.3km', '534.3km', '546.1km', '548.6km', '375.8km', '569.0km', '585.9km', '547.0km']
Generated 100/3000 multi-sat samples
Generated 200/3000 multi-sat samples
Generated 300/3000 multi-sat samples
Generated 400/3000 multi-sat samples
Generated 500/3000 multi-sat samples
Generated 600/3000 multi-sat samples
Generated 700/3000 multi-sat samples
Generated 800/3000 multi-sat samples
Generated 900/3000 multi-sat samples
Generated 1000/3000 multi-sat samples
Generated 1100/3000 multi-sat samples
Generated 1200/3000 multi-sat samples
Generated 1300/3000 multi-sat samples
Generated 1400/3000 multi-sat samples
Generated 1500/3000 multi-sat samples
Generated 1600/3000 multi-sat samples
Generated 1700/3000 multi-sat samples
Generated 1800/3000 multi-sat samples
Generated 1900/3000 multi-sat samples
Generated 2000/3000 multi-sat samples
Generated 2100/3000 multi-sat samples
Generated 2200/3000 multi-sat samples
Generated 2300/3000 multi-sat samples
Generated 2400/3000 multi-sat samples
Generated 2500/3000 multi-sat samples
Generated 2600/3000 multi-sat samples
Generated 2700/3000 multi-sat samples
Generated 2800/3000 multi-sat samples
Generated 2900/3000 multi-sat samples
Generated 3000/3000 multi-sat samples
Saving dataset to dataset/dataset_samples1500_sats12.pkl...
✓ Dataset saved to disk

=== DATA VALIDATION ===
Benign samples: 1500
Attack samples: 1500
Attack samples with emitter locations: 1500
Power ratio (attack/benign): 1.3404

Phase 4: Extracting features (GPU)...
2025-10-21 19:49:14.205780: I external/local_xla/xla/service/service.cc:163] XLA service 0x79945eeca3d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2025-10-21 19:49:14.205816: I external/local_xla/xla/service/service.cc:171]   StreamExecutor device (0): NVIDIA H100 NVL, Compute Capability 9.0
2025-10-21 19:49:14.234198: I external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:473] Loaded cuDNN version 90701
I0000 00:00:1761090554.545596   63457 device_compiler.h:196] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2025-10-21 19:50:17.366138: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:269] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.

Phase 5: Training dual-input CNN (H100 Optimized)...
Epoch 1/30
2025-10-21 19:50:49.705427: W tensorflow/compiler/tf2xla/kernels/random_ops.cc:62] Warning: Using tf.random.uniform with XLA compilation will ignore seeds; consider using tf.random.stateless_uniform instead if reproducible behavior is desired. model/dropout/dropout/random_uniform/RandomUniform
37/37 [==============================] - ETA: 0s - loss: 0.5632 - accuracy: 0.9134 - auc: 0.9666
Epoch 1: val_accuracy improved from -inf to 0.52083, saving model to model/best_model.keras
37/37 [==============================] - 13s 359ms/step - loss: 0.5632 - accuracy: 0.9134 - auc: 0.9666 - val_loss: 1.7177 - val_accuracy: 0.5208 - val_auc: 0.9960
Epoch 2/30
37/37 [==============================] - ETA: 0s - loss: 0.4035 - accuracy: 0.9548 - auc: 0.9892
Epoch 2: val_accuracy did not improve from 0.52083
37/37 [==============================] - 0s 4ms/step - loss: 0.4035 - accuracy: 0.9548 - auc: 0.9892 - val_loss: 2.0387 - val_accuracy: 0.5208 - val_auc: 1.0000
Epoch 3/30
37/37 [==============================] - ETA: 0s - loss: 0.3133 - accuracy: 0.9789 - auc: 0.9980
Epoch 3: val_accuracy did not improve from 0.52083
37/37 [==============================] - 0s 4ms/step - loss: 0.3133 - accuracy: 0.9789 - auc: 0.9980 - val_loss: 1.5812 - val_accuracy: 0.5208 - val_auc: 1.0000
Epoch 4/30
37/37 [==============================] - ETA: 0s - loss: 0.2421 - accuracy: 0.9970 - auc: 1.0000
Epoch 4: val_accuracy did not improve from 0.52083
37/37 [==============================] - 0s 4ms/step - loss: 0.2421 - accuracy: 0.9970 - auc: 1.0000 - val_loss: 0.9175 - val_accuracy: 0.5208 - val_auc: 1.0000
Epoch 5/30
37/37 [==============================] - ETA: 0s - loss: 0.2103 - accuracy: 1.0000 - auc: 1.0000
Epoch 5: val_accuracy improved from 0.52083 to 0.54340, saving model to model/best_model.keras
37/37 [==============================] - 0s 8ms/step - loss: 0.2103 - accuracy: 1.0000 - auc: 1.0000 - val_loss: 0.7543 - val_accuracy: 0.5434 - val_auc: 1.0000
Epoch 6/30
37/37 [==============================] - ETA: 0s - loss: 0.1885 - accuracy: 1.0000 - auc: 1.0000
Epoch 6: val_accuracy improved from 0.54340 to 0.57639, saving model to model/best_model.keras
37/37 [==============================] - 0s 9ms/step - loss: 0.1885 - accuracy: 1.0000 - auc: 1.0000 - val_loss: 0.7207 - val_accuracy: 0.5764 - val_auc: 1.0000
Epoch 7/30
37/37 [==============================] - ETA: 0s - loss: 0.1684 - accuracy: 1.0000 - auc: 1.0000
Epoch 7: val_accuracy improved from 0.57639 to 0.81771, saving model to model/best_model.keras
37/37 [==============================] - 0s 8ms/step - loss: 0.1684 - accuracy: 1.0000 - auc: 1.0000 - val_loss: 0.4724 - val_accuracy: 0.8177 - val_auc: 1.0000
Epoch 8/30
37/37 [==============================] - ETA: 0s - loss: 0.1497 - accuracy: 1.0000 - auc: 1.0000
Epoch 8: val_accuracy did not improve from 0.81771
37/37 [==============================] - 0s 4ms/step - loss: 0.1497 - accuracy: 1.0000 - auc: 1.0000 - val_loss: 0.4683 - val_accuracy: 0.8160 - val_auc: 1.0000
Epoch 9/30
37/37 [==============================] - ETA: 0s - loss: 0.1328 - accuracy: 1.0000 - auc: 1.0000
Epoch 9: val_accuracy improved from 0.81771 to 0.85764, saving model to model/best_model.keras
37/37 [==============================] - 0s 7ms/step - loss: 0.1328 - accuracy: 1.0000 - auc: 1.0000 - val_loss: 0.3903 - val_accuracy: 0.8576 - val_auc: 1.0000
Epoch 10/30
37/37 [==============================] - ETA: 0s - loss: 0.1178 - accuracy: 1.0000 - auc: 1.0000
Epoch 10: val_accuracy improved from 0.85764 to 0.96354, saving model to model/best_model.keras
37/37 [==============================] - 0s 8ms/step - loss: 0.1178 - accuracy: 1.0000 - auc: 1.0000 - val_loss: 0.2164 - val_accuracy: 0.9635 - val_auc: 1.0000
Epoch 11/30
37/37 [==============================] - ETA: 0s - loss: 0.1055 - accuracy: 0.9992 - auc: 1.0000
Epoch 11: val_accuracy improved from 0.96354 to 0.99479, saving model to model/best_model.keras
37/37 [==============================] - 0s 7ms/step - loss: 0.1055 - accuracy: 0.9992 - auc: 1.0000 - val_loss: 0.1293 - val_accuracy: 0.9948 - val_auc: 1.0000
Epoch 12/30
37/37 [==============================] - ETA: 0s - loss: 0.0929 - accuracy: 1.0000 - auc: 1.0000
Epoch 12: val_accuracy did not improve from 0.99479
37/37 [==============================] - 0s 4ms/step - loss: 0.0929 - accuracy: 1.0000 - auc: 1.0000 - val_loss: 0.2460 - val_accuracy: 0.9219 - val_auc: 1.0000
Epoch 13/30
37/37 [==============================] - ETA: 0s - loss: 0.0821 - accuracy: 1.0000 - auc: 1.0000
Epoch 13: val_accuracy improved from 0.99479 to 0.99826, saving model to model/best_model.keras
37/37 [==============================] - 0s 9ms/step - loss: 0.0821 - accuracy: 1.0000 - auc: 1.0000 - val_loss: 0.0991 - val_accuracy: 0.9983 - val_auc: 1.0000
Epoch 14/30
37/37 [==============================] - ETA: 0s - loss: 0.0725 - accuracy: 1.0000 - auc: 1.0000
Epoch 14: val_accuracy improved from 0.99826 to 1.00000, saving model to model/best_model.keras
37/37 [==============================] - 0s 7ms/step - loss: 0.0725 - accuracy: 1.0000 - auc: 1.0000 - val_loss: 0.0736 - val_accuracy: 1.0000 - val_auc: 1.0000
Epoch 15/30
37/37 [==============================] - ETA: 0s - loss: 0.0641 - accuracy: 1.0000 - auc: 1.0000
Epoch 15: val_accuracy did not improve from 1.00000
37/37 [==============================] - 0s 4ms/step - loss: 0.0641 - accuracy: 1.0000 - auc: 1.0000 - val_loss: 0.0615 - val_accuracy: 1.0000 - val_auc: 1.0000
Epoch 16/30
37/37 [==============================] - ETA: 0s - loss: 0.0568 - accuracy: 1.0000 - auc: 1.0000
Epoch 16: val_accuracy did not improve from 1.00000
37/37 [==============================] - 0s 4ms/step - loss: 0.0568 - accuracy: 1.0000 - auc: 1.0000 - val_loss: 0.0534 - val_accuracy: 1.0000 - val_auc: 1.0000
Epoch 17/30
37/37 [==============================] - ETA: 0s - loss: 0.0504 - accuracy: 1.0000 - auc: 1.0000
Epoch 17: val_accuracy did not improve from 1.00000
37/37 [==============================] - 0s 4ms/step - loss: 0.0504 - accuracy: 1.0000 - auc: 1.0000 - val_loss: 0.0473 - val_accuracy: 1.0000 - val_auc: 1.0000
Epoch 18/30
37/37 [==============================] - ETA: 0s - loss: 0.0448 - accuracy: 1.0000 - auc: 1.0000
Epoch 18: val_accuracy did not improve from 1.00000
37/37 [==============================] - 0s 4ms/step - loss: 0.0448 - accuracy: 1.0000 - auc: 1.0000 - val_loss: 0.0421 - val_accuracy: 1.0000 - val_auc: 1.0000
Epoch 19/30
37/37 [==============================] - ETA: 0s - loss: 0.0398 - accuracy: 1.0000 - auc: 1.0000
Epoch 19: val_accuracy did not improve from 1.00000
37/37 [==============================] - 0s 4ms/step - loss: 0.0398 - accuracy: 1.0000 - auc: 1.0000 - val_loss: 0.0374 - val_accuracy: 1.0000 - val_auc: 1.0000
Epoch 20/30
37/37 [==============================] - ETA: 0s - loss: 0.0354 - accuracy: 1.0000 - auc: 1.0000
Epoch 20: val_accuracy did not improve from 1.00000
37/37 [==============================] - 0s 4ms/step - loss: 0.0354 - accuracy: 1.0000 - auc: 1.0000 - val_loss: 0.0333 - val_accuracy: 1.0000 - val_auc: 1.0000
Epoch 21/30
37/37 [==============================] - ETA: 0s - loss: 0.0316 - accuracy: 1.0000 - auc: 1.0000
Epoch 21: val_accuracy did not improve from 1.00000
37/37 [==============================] - 0s 4ms/step - loss: 0.0316 - accuracy: 1.0000 - auc: 1.0000 - val_loss: 0.0297 - val_accuracy: 1.0000 - val_auc: 1.0000
Epoch 22/30
37/37 [==============================] - ETA: 0s - loss: 0.0282 - accuracy: 1.0000 - auc: 1.0000
Epoch 22: val_accuracy did not improve from 1.00000
37/37 [==============================] - 0s 4ms/step - loss: 0.0282 - accuracy: 1.0000 - auc: 1.0000 - val_loss: 0.0266 - val_accuracy: 1.0000 - val_auc: 1.0000
Epoch 23/30
37/37 [==============================] - ETA: 0s - loss: 0.0257 - accuracy: 0.9996 - auc: 1.0000
Epoch 23: val_accuracy did not improve from 1.00000
37/37 [==============================] - 0s 4ms/step - loss: 0.0257 - accuracy: 0.9996 - auc: 1.0000 - val_loss: 0.2199 - val_accuracy: 0.9427 - val_auc: 0.9867
Epoch 24/30
37/37 [==============================] - ETA: 0s - loss: 0.0300 - accuracy: 0.9983 - auc: 1.0000
Epoch 24: val_accuracy did not improve from 1.00000
37/37 [==============================] - 0s 4ms/step - loss: 0.0300 - accuracy: 0.9983 - auc: 1.0000 - val_loss: 0.0292 - val_accuracy: 1.0000 - val_auc: 1.0000
Epoch 24: early stopping
Restoring model weights from the end of the best epoch: 14.

=== TRAIN SUMMARY ===
Best epoch: 2
Best val_auc: 1.0000
Final train_acc: 0.9983

Evaluating on test set (H100)...
Test Results → Loss: 0.0739 | Acc: 1.0000 | AUC: 1.0000

=== THRESHOLD TUNING ===
Default threshold (0.5) results:
  F1 score: 1.0000

Optimized threshold: 0.7732
  Best F1 score: 1.0000
  Precision at best threshold: 1.0000
  Recall at best threshold: 1.0000
  Improvement: 0.00%

=== GENERATING PAPER PLOTS ===

=== CONFUSION MATRIX ===
                Predicted
              Benign  Attack
Actual Benign   313       0
       Attack     1     286

=== CLASSIFICATION REPORT ===
              precision    recall  f1-score   support

      Benign       1.00      1.00      1.00       313
      Attack       1.00      1.00      1.00       287

    accuracy                           1.00       600
   macro avg       1.00      1.00      1.00       600
weighted avg       1.00      1.00      1.00       600

AUPRC (avg precision): 1.000
✓ ROC curve saved to result/1_roc_curve.pdf
✓ Precision-Recall curve saved to result/2_precision_recall_curve.pdf
✓ Confusion Matrix saved to result/3_confusion_matrix.pdf
✓ Training History saved to result/5_training_history.pdf
✓ Power Spectrum saved to result/6_power_spectrum.pdf
✓ F1 vs Threshold saved to result/7_f1_vs_threshold.pdf
✓ Spectrogram Examples saved to result/9_spectrogram_examples.pdf
✓ Satellite Geometry saved to result/10_satellite_geometry.pdf

=== PHASE 8: TDoA-BASED LOCALIZATION ===
Processing true positives...
  Sample 1801 | GT [-41067.75672422  11911.86030261] | EST [-41074.78196389  11895.58829114] | Error=17.72 m
  Sample 2579 | GT [ 26766.95414458 137979.27161791] | EST [ 26771.24164366 137951.78773863] | Error=27.82 m
  Sample 2254 | GT [ 47005.63898793 -17256.80373982] | EST [ 47005.170985   -17204.79124594] | Error=52.01 m

=== TDoA Localization Results ===
Median Error: 40.23 m
Mean Error  : 43.11 m
90th Perc.  : 74.56 m
Total samples: 97
✓ Localization CDF saved to result/4_localization_cdf.pdf
✓ Localization Histogram saved to result/8_localization_histogram.pdf
✓ Localization errors written to result/localization_errors.txt

============================================================
SIMULATION COMPLETE - SUMMARY
============================================================
Dataset: 3000 samples (1500 per class)
Model: Dual-Input CNN (saved to model/)
Results: All plots saved to result/
Best Threshold: 0.7732 (F1=1.0000)
Localization: Median Error = 40.23 m, 90th = 74.56 m
============================================================
root@d05388087b30:/workspace# 